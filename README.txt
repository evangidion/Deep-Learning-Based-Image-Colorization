To create a new "estimations_test.npy" file, just run the file "the3.py" as "python the3.py". It trains the best model, save model parameters, then load them to predict 100 images from test set. Finally, it creates "estimations_test.npy" file with the predicted images after reshaping and scaling predictions. However, before running "the3.py", please delete "test_images.txt" file since it is opened with "append" mode. Thus, if it is not deleted, "test_images.txt" will contain 200 image paths instead of 100. Moreover, grayscale test images are extracted as "test/images_grayscale/x.jpg" instead of "images_grayscale/x.jpg" because pytorch data loaders want 2 layer directories. Hence, paths of the images were written like this to "test_images.txt". You can examine model performance from "best.txt" after running "the3.py". Before running "the3.py", if you want to oberve predicted images, uncomment lines 344, 345, 357, then after running "the3.py", look at "tests" directory. Also, before running the code, if you want to plot graphs, uncomment lines 264-284, then after running "the3.py", look at "best" directory.  